<ui:composition lang="es" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/WEB-INF/templates/template-interno.xhtml">
	<ui:define name="title">#{texto.Estadisticas}</ui:define>
	<ui:define name="head">
		<style type="text/css">
${
demo
.css
}
</style>
		<h:panelGroup
			rendered="#{compararEstadisticasManagedBean.idUsuario ne null}">
			<script type="text/javascript">
            $(function () {
                $('#container').highcharts(
                        {
                        	chart: {
                                type: 'line'
                            },
                            title: {
                                text: '#{texto.ComparacionDePromedios}'
                            },
                            subtitle: {
                                text: '#{texto.ComparacionDePromediosPorCategoria}'
                            },
                            xAxis: {
                                type: 'datetime',
                                dateTimeLabelFormats: {
                                	day: '%d/%b',
                                    week: '%d/%b',
                                    month: '%d/%b/%Y',
                                    year: '%Y'
                                }
                            },
                            yAxis: {
                                title: {
                                    text: '#{texto.Promedio}'
                                },
                                min: 0,
                                labels: {
                                    formatter: function () {
                                 	   var ms = this.value;
                                        var m=Math.floor(ms/60000);
                                        ms-=(m*60000);
                                        var s=Math.floor(ms/1000);
                                        ms-=(s*1000);
                                        ms=Math.floor(ms/10);
                                        return ((m>9)?m:('0'+m))+':'+((s>9)?s:('0'+s))+'.'+ ((ms>9)?ms:('0'+ms));
                                    }
                                }
                            },
                            legend: {
                                enabled: true
                            },
                            tooltip: {
                            	headerFormat: '&lt;b&gt;{series.name}&lt;/b&gt;&lt;br&gt;',
                            	formatter: function () {
                              	   var ms = this.y;
                                     var m=Math.floor(ms/60000);
                                     ms-=(m*60000);
                                     var s=Math.floor(ms/1000);
                                     ms-=(s*1000);
                                     ms=Math.floor(ms/10);
                                     return "&lt;b&gt;"+((new Date(this.x).getUTCDate()>9)?new Date(this.x).getUTCDate():'0'+new Date(this.x).getUTCDate())
                                     +'/'+(((new Date(this.x).getUTCMonth()+1)>9)?(new Date(this.x).getUTCMonth()+1):'0'+(new Date(this.x).getUTCMonth()+1))
                                     +'/'+(new Date(this.x).getUTCFullYear())+ "&lt;/ b&gt;&lt;br /&gt;" 
                                     +'AVG = '+((m>9)?m:('0'+m))+':'+((s>9)?s:('0'+s))+'.'+ ((ms>9)?ms:('0'+ms));
                                 }
                            },
                            plotOptions: {
                                spline: {
                                    marker: {
                                        enabled: true
                                    }
                                }
                            },
                            series: [#{compararEstadisticasManagedBean.listaPromediosComparacion.obtenerDatos()}]
                        });
            });
            </script>
		</h:panelGroup>
	</ui:define>
	<ui:define name="body">
		<div class="col-xs-12">
			<h:form>
				<h:panelGroup>
					<h:outputText value="#{texto.CompararCon}: "></h:outputText>
					<h:selectOneMenu value="#{compararEstadisticasManagedBean.idAmigo}"
						styleClass="form-control input-sm" onchange="submit()"
						valueChangeListener="#{compararEstadisticasManagedBean.cambioAmigo}">
						<f:selectItems
							value="#{compararEstadisticasManagedBean.listaAmigos}"
							var="amigo" itemValue="#{amigo.idUsuario}"
							itemLabel="#{amigo.nombres} #{amigo.apellidos} - #{amigo.correo}"></f:selectItems>
					</h:selectOneMenu>
				</h:panelGroup>
			</h:form>
			<h:panelGroup
				rendered="#{compararEstadisticasManagedBean.idAmigo eq null and compararEstadisticasManagedBean.idUsuario ne null and compararEstadisticasManagedBean.listaAmigos.isEmpty()}">
				<div>#{texto.AunNoTienesAmigos}</div>
			</h:panelGroup>
			<h:panelGroup
				rendered="#{compararEstadisticasManagedBean.idAmigo eq null and compararEstadisticasManagedBean.idUsuario ne null and !compararEstadisticasManagedBean.listaAmigos.isEmpty()}">
				<div>#{texto.PorFavorSeleccionaUnAmigoParaComparar}</div>
			</h:panelGroup>
			<h:panelGroup
				rendered="#{compararEstadisticasManagedBean.idAmigo ne null and compararEstadisticasManagedBean.idUsuario ne null}">
				<div class="col-xs-12 contactenos">
					<script
						src="#{sesionManagedBean.contextPath}/resources/js/highcharts.js"
						type="text/javascript"></script>
					<script
						src="#{sesionManagedBean.contextPath}/resources/js/highcharts-3d.js"
						type="text/javascript"></script>
					<script
						src="#{sesionManagedBean.contextPath}/resources/js/modules/exporting.js"></script>
					<div id="container" class="col-xs-12"
						style="height: 400px; margin-bottom: 10px;"></div>
					<!-- 				<div id="container2" class="col-xs-12 col-md-6" -->
					<!-- 					style="height: 400px; margin-bottom: 10px;"></div> -->
					<!-- 				<div id="container3" class="col-xs-12 col-md-6" -->
					<!-- 					style="height: 400px; margin-bottom: 10px;"></div> -->
				</div>
			</h:panelGroup>
		</div>
	</ui:define>
</ui:composition>